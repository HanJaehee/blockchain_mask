<!DOCTYPE html>
<html lang="en" dir="ltr">

<head style="height:100%;">

   
  <script src="./MyFunctions.js"></script>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

  <meta charset="utf-8">
  <title>Manufacturer Page</title>
</head>

<body style="height:100%;">

  <div class="container" style="padding-top:20px">
    <form class="form-inline">
      <div class="form-group">
        <label class="sr-only" for="id">id</label>
        <p id="id"></p>
      </div>

    </form>
  </div>
  <h1 class="text-center">제조사 페이지</h1>
  <hr><br>
  <!-- 생성내역 시작 -->
  <div class="container">
    <div class="panel panel-default">
      <h1 class="text-center">생성내역</h1>
      <hr>
      <div class=".col-md-6 .col-md-offset-3">

        <!-- 생성내역 테이블 시작 -->
        <div id="table-wrapper" style="height: 300px; overflow-y: scroll;">
          <table class="table table-hover" id="addedMaskListTable">
            <thead>
              <tr>
                <th>생성시간</th>
                <th>일련번호</th>
                <th>개수 (1Box = 500개)</th>
              </tr>
            </thead>
            <tbody id="maskListTbody">
              <tr>
                <td>111</td>
                <td>123</td>
                <th>1Box</th>
              </tr>
              <tr>
                <td>111</td>
                <td>456</td>
                <th>1Box</th>
              </tr>
              <tr>
                <td>111</td>
                <td>789</td>
                <th>1Box</th>
              </tr>
            </tbody>
          </table>
          <!-- 생성내역 테이블 끝 -->
        </div>
        <hr>
        <!-- 마스크추가 폼 시작 -->
        <div class="container" style="margin-bottom:20px; margin-top:20px">
          <form class="form-inline">
            <div class="form-group">
              <!-- <label for="count1">개수</label>
              <input type="number" class="form-control" id="count1" placeholder="Box 단위(1Box = 500개)"> -->
              <button type="button" class="btn btn-outline-dark" id="addMask" onclick="AddMask()">마스크 추가</button>
            </div>
          </form>
        </div>
        <br>
        <!-- 마스크추가 폼 끝 -->
          <!-- 마스크 보내기 폼 시작 -->
          <div class="container">
            <form class="form-inline">
              <div class="form-group">
                <div class="input-group-prepend">
                  <span class="input-group-text" id="basic-addon1">일련번호</span>
                </div>
             
              <input type="text" class="form-control" id="serialNumber2" placeholder="일련번호">
              <div class="input-group-prepend">
                <span class="input-group-text" id="basic-addon1">유통사</span>
              </div>
              </div>
              <input type="text" class="form-control" id="toDistributor" placeholder="유통사1">
              <button type="submit" class="btn btn-outline-dark" id="sendMask" onclick="SendMask()">보내기</button>
            </form>
          </div>
          <!-- 마스크 보내기 폼 끝 -->
      </div>
    </div>
  </div>
  <!-- 생성내역 끝 -->

  <br><br>
  <!-- 거래내역 시작 -->
  <div class="container">
    <div class="panel panel-default">
      <h1 class="text-center">거래내역</h1>
      <hr>
      <div class=".col-md-6 .col-md-offset-3">

        <!-- 거래내역 테이블 시작 -->
        <div id="table-wrapper" style="height: 300px; overflow-y: scroll;">
          <table class="table table-hover" id="transactionListTable">
            <thead>
              <tr>
                <th>생성시간</th>
                <th>일련번호</th>
                <th>개수</th>
                <th>제조사</th>
                <th>유통사</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>시간</td>
                <td>123456789</td>
                <td>20</td>
                <td>제조사1(현재 제조사의 이름이 들어가야함)</td>
                <td>유통사1</td>
              </tr>
              <tr>
                <td>시간</td>
                <td>123456789</td>
                <td>20</td>
                <td>제조사1(현재 제조사의 이름이 들어가야함)</td>
                <td>유통사1</td>
              </tr>
              <tr>
                <td>시간</td>
                <td>123456789</td>
                <td>20</td>
                <td>제조사1(현재 제조사의 이름이 들어가야함)</td>
                <td>유통사1</td>
              </tr>
              
            </tbody>
          </table>
          <!-- 거래내역 테이블 끝 -->
        </div>
        <hr>
      
        <br><br>
        
      </div>
    </div>
  </div>
  

  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-app.js"></script>

  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#available-libraries -->
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-analytics.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-database.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.14.0/firebase-firestore.js"></script>
  <script src="./firebaseInit.js"></script>
  <script src="./firebaseUserCheck.js" charset="utf-8"></script>
  <script>
    userSessionCheck();
  </script>
  <script>
    //마스크 추가 함수
    function AddMask() {
      var ourRequest = new XMLHttpRequest();
      //var serialNumber = document.getElementById("serialNumber1").value;
      //var count = document.getElementById("count1").value;


      //위의 변수를 가지고 web3를 통해 컨트랙트 함수 실행
      ourRequest.open('GET', 'http://localhost:8000/maskMaking/'+serialNumber+'/'+count);//이부분 수정해야함
    ourRequest.send();
    }
    //마스크 보내기 함수
    function SendMask() {
      var serialNumber = document.getElementById("serialNumber2");
      var toDistributor = document.getElementById("toDistributor");
      //var count = document.getElementById("count2");

      //위의 변수를 가지고 web3를 통해 컨트랙트 함수 실행
     
    }
    //마스크 생성내역 테이블 만드는 함수
    function MakeAddedMaskListTable() {

    }
    //거래내역 테이블 만드는 함수
    function MakeTransactionListTable() {

    }
  </script>
  <!-- httpRequest JSON parsing script -->
 <script type="text/javascript">
  var myTbody = document.getElementById("myTbody");
  var ourRequest = new XMLHttpRequest();
  var exampleInfo = document.getElementById("exampleInfo");
  ourRequest.open('GET', 'http://localhost:8000/getMaskInfo/5');
  ourRequest.onload = function() {
    var ourData = JSON.parse(ourRequest.responseText);
    console.log(ourData);
    renderHTML(ourData);
  };
  ourRequest.send();

  function renderHTML(data) {
    console.log("renderHTML 함수 실행됨");
    var htmlString = "";

    //  for (i = 0; i < data.length; i++) {
    //    htmlString+= "<tr><td>"+data[i].date+"</td>";
    //     htmlString+= "<td>"+data[i].manufacturerName+"</td>";
    //       htmlString+= "<td>"+500+"</td></tr>";
    //  }
    htmlString = "<tr><td>"+new Date(data.date * 1000).toLocaleString()+"</td>" + "<td>"+data.manufacturerName+"</td>" + "<td>"+"1box"+"</td></tr>";
    $("#maskListTbody").append(htmlString);
    console.log(htmlString);
  
  }
</script>
<script>
  //테이블 행 클릭시 해당 정보 가져오는 JQuery  
    $("#addedMaskListTable tr").click(function(){     
 
 var str = "";
 var tdArr = new Array();    // 배열 선언
     
 // 현재 클릭된 Row(<tr>)
 var tr = $(this);
 var td = tr.children();

 // tr.text()는 클릭된 Row 즉 tr에 있는 모든 값을 가져온다.
 console.log("클릭한 Row의 모든 데이터 : "+tr.text());
            
            // 반복문을 이용해서 배열에 값을 담아 사용할 수 도 있다.
            td.each(function(i){
                tdArr.push(td.eq(i).text());
            });
                    
            $('#serialNumber2').val(tdArr[1]);
        
      
 });
 
</script>
</body>

</html>
